<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>kafka-component.mock documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Kafka-component</span> <span class="project-version">0.5.12-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="README.html"><div class="inner"><span>kafka-component</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kafka-component</span></div></div></li><li class="depth-2 branch"><a href="kafka-component.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-2 branch"><a href="kafka-component.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 current"><a href="kafka-component.mock.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mock</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="kafka-component.mock.html#var--.3Etopic-partition"><div class="inner"><span>-&gt;topic-partition</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-accumulate-messages"><div class="inner"><span>accumulate-messages</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-accumulate-subscribed-messages"><div class="inner"><span>accumulate-subscribed-messages</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-add-record-in-broker-state"><div class="inner"><span>add-record-in-broker-state</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-add-record-to-topic"><div class="inner"><span>add-record-to-topic</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-assert-producer-not-closed"><div class="inner"><span>assert-producer-not-closed</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-assert-proper-record"><div class="inner"><span>assert-proper-record</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-assign-partitions"><div class="inner"><span>assign-partitions</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-broker-create-topic"><div class="inner"><span>broker-create-topic</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-broker-ensure-topic"><div class="inner"><span>broker-ensure-topic</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-broker-receive-messages"><div class="inner"><span>broker-receive-messages</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-broker-save-record.21"><div class="inner"><span>broker-save-record!</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-broker-state"><div class="inner"><span>broker-state</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-buffer-size"><div class="inner"><span>buffer-size</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-close-all-from"><div class="inner"><span>close-all-from</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-close-mock"><div class="inner"><span>close-mock</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-committed-offsets"><div class="inner"><span>committed-offsets</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-committed-record-metadata"><div class="inner"><span>committed-record-metadata</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-consumer-backoff"><div class="inner"><span>consumer-backoff</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-consumer-coordinator"><div class="inner"><span>consumer-coordinator</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-consumer-rebalance-timeout"><div class="inner"><span>consumer-rebalance-timeout</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-consumer-unsubscribe-timeout"><div class="inner"><span>consumer-unsubscribe-timeout</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-consumers-with-topic-overlap"><div class="inner"><span>consumers-with-topic-overlap</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-debug"><div class="inner"><span>debug</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-debug.21"><div class="inner"><span>debug!</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-default-mock-consumer-opts"><div class="inner"><span>default-mock-consumer-opts</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-default-num-partitions"><div class="inner"><span>default-num-partitions</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-fixture-restart-broker.21"><div class="inner"><span>fixture-restart-broker!</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-get-messages"><div class="inner"><span>get-messages</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-get-offset"><div class="inner"><span>get-offset</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-goe"><div class="inner"><span>goe</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-goe-loop"><div class="inner"><span>goe-loop</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-intersects.3F"><div class="inner"><span>intersects?</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-IRebalance"><div class="inner"><span>IRebalance</span></div></a></li><li class="depth-2 branch"><a href="kafka-component.mock.html#var-all-topics"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>all-topics</span></div></a></li><li class="depth-2 branch"><a href="kafka-component.mock.html#var-apply-pending-topics"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>apply-pending-topics</span></div></a></li><li class="depth-2"><a href="kafka-component.mock.html#var-clean-up-subscriptions"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clean-up-subscriptions</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-logger"><div class="inner"><span>logger</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-max-poll-records"><div class="inner"><span>max-poll-records</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-mock-consumer"><div class="inner"><span>mock-consumer</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-mock-producer"><div class="inner"><span>mock-producer</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-noop-cb"><div class="inner"><span>noop-cb</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-producer-record-.3Econsumer-record"><div class="inner"><span>producer-record-&gt;consumer-record</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-read-offsets"><div class="inner"><span>read-offsets</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-rebalance-consumers"><div class="inner"><span>rebalance-consumers</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-rebalance-participants"><div class="inner"><span>rebalance-participants</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-rebalance-participants-timeout"><div class="inner"><span>rebalance-participants-timeout</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-record-.3Eclj"><div class="inner"><span>record-&gt;clj</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-record-.3Etopic-partition"><div class="inner"><span>record-&gt;topic-partition</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-records-.3Eclj"><div class="inner"><span>records-&gt;clj</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-reset-state.21"><div class="inner"><span>reset-state!</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-send"><div class="inner"><span>send</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-send-async"><div class="inner"><span>send-async</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-shutdown.21"><div class="inner"><span>shutdown!</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-standalone-mock-consumer-opts"><div class="inner"><span>standalone-mock-consumer-opts</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-start.21"><div class="inner"><span>start!</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-txfm-messages"><div class="inner"><span>txfm-messages</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-txfm-subscribed-messages"><div class="inner"><span>txfm-subscribed-messages</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-with-test-broker"><div class="inner"><span>with-test-broker</span></div></a></li><li class="depth-1"><a href="kafka-component.mock.html#var-with-test-producer-consumer"><div class="inner"><span>with-test-producer-consumer</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">kafka-component.mock</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var--.3Etopic-partition"><h3>-&gt;topic-partition</h3><div class="usage"><code>(-&gt;topic-partition topic partition)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L58">view source</a></div></div><div class="public anchor" id="var-accumulate-messages"><h3>accumulate-messages</h3><div class="usage"><code>(accumulate-messages consumer topic options)</code></div><div class="doc"><div class="markdown"><p>Like <code>accumulate-subscribed-messages</code>, but subscribes to the <code>topic</code> first.</p></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L534">view source</a></div></div><div class="public anchor" id="var-accumulate-subscribed-messages"><h3>accumulate-subscribed-messages</h3><div class="usage"><code>(accumulate-subscribed-messages consumer {:keys [timeout at-least-n format-fn filter-fn], :or {at-least-n 1, format-fn identity, filter-fn identity}})</code></div><div class="doc"><div class="markdown"><p>Helper to consume messages off any existing subscriptions. Will return as soon as <code>at-least-n</code> messages have been fetched. May return more, since an individual poll can fetch more. If <code>timeout</code> (in ms) expires first, returns any messages fetched so far. Mesages may be reformatted with <code>format-fn</code> then filtered with <code>filter-fn</code>. Messages excluded by <code>filter-fn</code> do not count towards <code>at-least-n</code>.</p></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L512">view source</a></div></div><div class="public anchor" id="var-add-record-in-broker-state"><h3>add-record-in-broker-state</h3><div class="usage"><code>(add-record-in-broker-state state producer-record)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L83">view source</a></div></div><div class="public anchor" id="var-add-record-to-topic"><h3>add-record-to-topic</h3><div class="usage"><code>(add-record-to-topic state producer-record)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L77">view source</a></div></div><div class="public anchor" id="var-assert-producer-not-closed"><h3>assert-producer-not-closed</h3><div class="usage"><code>(assert-producer-not-closed producer-state)</code></div><div class="doc"><div class="markdown"><p>Checks conn-open? in producer state</p></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L424">view source</a></div></div><div class="public anchor" id="var-assert-proper-record"><h3>assert-proper-record</h3><div class="usage"><code>(assert-proper-record record)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L422">view source</a></div></div><div class="public anchor" id="var-assign-partitions"><h3>assign-partitions</h3><div class="usage"><code>(assign-partitions broker-state consumers participants participants-ch complete-ch)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L142">view source</a></div></div><div class="public anchor" id="var-broker-create-topic"><h3>broker-create-topic</h3><div class="usage"><code>(broker-create-topic)</code><code>(broker-create-topic num-partitions)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L64">view source</a></div></div><div class="public anchor" id="var-broker-ensure-topic"><h3>broker-ensure-topic</h3><div class="usage"><code>(broker-ensure-topic broker-state topic)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L69">view source</a></div></div><div class="public anchor" id="var-broker-receive-messages"><h3>broker-receive-messages</h3><div class="usage"><code>(broker-receive-messages state msg-ch)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L128">view source</a></div></div><div class="public anchor" id="var-broker-save-record.21"><h3>broker-save-record!</h3><div class="usage"><code>(broker-save-record! state record)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L120">view source</a></div></div><div class="public anchor" id="var-broker-state"><h3>broker-state</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L35">view source</a></div></div><div class="public anchor" id="var-buffer-size"><h3>buffer-size</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L41">view source</a></div></div><div class="public anchor" id="var-close-all-from"><h3>close-all-from</h3><div class="usage"><code>(close-all-from ch)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L103">view source</a></div></div><div class="public anchor" id="var-close-mock"><h3>close-mock</h3><div class="usage"><code>(close-mock state)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L240">view source</a></div></div><div class="public anchor" id="var-committed-offsets"><h3>committed-offsets</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L39">view source</a></div></div><div class="public anchor" id="var-committed-record-metadata"><h3>committed-record-metadata</h3><div class="usage"><code>(committed-record-metadata record)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L115">view source</a></div></div><div class="public anchor" id="var-consumer-backoff"><h3>consumer-backoff</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L43">view source</a></div></div><div class="public anchor" id="var-consumer-coordinator"><h3>consumer-coordinator</h3><div class="usage"><code>(consumer-coordinator state broker-state join-ch leave-ch)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L193">view source</a></div></div><div class="public anchor" id="var-consumer-rebalance-timeout"><h3>consumer-rebalance-timeout</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L45">view source</a></div></div><div class="public anchor" id="var-consumer-unsubscribe-timeout"><h3>consumer-unsubscribe-timeout</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L46">view source</a></div></div><div class="public anchor" id="var-consumers-with-topic-overlap"><h3>consumers-with-topic-overlap</h3><div class="usage"><code>(consumers-with-topic-overlap consumers topics)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L190">view source</a></div></div><div class="public anchor" id="var-debug"><h3>debug</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L28">view source</a></div></div><div class="public anchor" id="var-debug.21"><h3>debug!</h3><div class="usage"><code>(debug! enable)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L225">view source</a></div></div><div class="public anchor" id="var-default-mock-consumer-opts"><h3>default-mock-consumer-opts</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L21">view source</a></div></div><div class="public anchor" id="var-default-num-partitions"><h3>default-num-partitions</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L42">view source</a></div></div><div class="public anchor" id="var-fixture-restart-broker.21"><h3>fixture-restart-broker!</h3><div class="usage"><code>(fixture-restart-broker! f)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L235">view source</a></div></div><div class="public anchor" id="var-get-messages"><h3>get-messages</h3><h4 class="deprecated">deprecated in 0.5.10</h4><div class="usage"><code>(get-messages consumer topic timeout)</code><code>(get-messages consumer timeout)</code></div><div class="doc"><div class="markdown"><p>DEPRECATED: use <code>txfm-messages</code> instead. Poll until <code>consumer</code> receives some messages on <code>topic</code>. If <code>timeout</code> (in ms) expires first, return an empty vector.</p></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L496">view source</a></div></div><div class="public anchor" id="var-get-offset"><h3>get-offset</h3><div class="usage"><code>(get-offset broker-state topic partition config)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L254">view source</a></div></div><div class="public anchor" id="var-goe"><h3>goe</h3><h4 class="type">macro</h4><div class="usage"><code>(goe &amp; body)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L89">view source</a></div></div><div class="public anchor" id="var-goe-loop"><h3>goe-loop</h3><h4 class="type">macro</h4><div class="usage"><code>(goe-loop &amp; body)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L98">view source</a></div></div><div class="public anchor" id="var-intersects.3F"><h3>intersects?</h3><div class="usage"><code>(intersects? v1 v2)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L187">view source</a></div></div><div class="public anchor" id="var-IRebalance"><h3>IRebalance</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-all-topics"><h3>all-topics</h3><div class="usage"><code>(all-topics this)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-apply-pending-topics"><h3>apply-pending-topics</h3><div class="usage"><code>(apply-pending-topics this topics)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-clean-up-subscriptions"><h3>clean-up-subscriptions</h3><div class="usage"><code>(clean-up-subscriptions this)</code></div><div class="doc"><div class="markdown"></div></div></div></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L137">view source</a></div></div><div class="public anchor" id="var-logger"><h3>logger</h3><div class="usage"><code>(logger &amp; args)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L48">view source</a></div></div><div class="public anchor" id="var-max-poll-records"><h3>max-poll-records</h3><div class="usage"><code>(max-poll-records config)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L247">view source</a></div></div><div class="public anchor" id="var-mock-consumer"><h3>mock-consumer</h3><div class="usage"><code>(mock-consumer config)</code><code>(mock-consumer auto-subscribe-topics config)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L404">view source</a></div></div><div class="public anchor" id="var-mock-producer"><h3>mock-producer</h3><div class="usage"><code>(mock-producer config)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L470">view source</a></div></div><div class="public anchor" id="var-noop-cb"><h3>noop-cb</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L428">view source</a></div></div><div class="public anchor" id="var-producer-record-.3Econsumer-record"><h3>producer-record-&gt;consumer-record</h3><div class="usage"><code>(producer-record-&gt;consumer-record offset record)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L74">view source</a></div></div><div class="public anchor" id="var-read-offsets"><h3>read-offsets</h3><div class="usage"><code>(read-offsets grouped-messages)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L243">view source</a></div></div><div class="public anchor" id="var-rebalance-consumers"><h3>rebalance-consumers</h3><div class="usage"><code>(rebalance-consumers relevant-consumers broker-state)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L179">view source</a></div></div><div class="public anchor" id="var-rebalance-participants"><h3>rebalance-participants</h3><div class="usage"><code>(rebalance-participants broker-state consumers participants-ch complete-ch)</code></div><div class="doc"><div class="markdown"><p>Try to get all the consumers to participate in the rebalance, but if they don’t all check in, continue without some of them.</p></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L163">view source</a></div></div><div class="public anchor" id="var-rebalance-participants-timeout"><h3>rebalance-participants-timeout</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L44">view source</a></div></div><div class="public anchor" id="var-record-.3Eclj"><h3>record-&gt;clj</h3><div class="usage"><code>(record-&gt;clj record)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L483">view source</a></div></div><div class="public anchor" id="var-record-.3Etopic-partition"><h3>record-&gt;topic-partition</h3><div class="usage"><code>(record-&gt;topic-partition record)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L61">view source</a></div></div><div class="public anchor" id="var-records-.3Eclj"><h3>records-&gt;clj</h3><div class="usage"><code>(records-&gt;clj consumer-records)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L490">view source</a></div></div><div class="public anchor" id="var-reset-state.21"><h3>reset-state!</h3><div class="usage"><code>(reset-state!)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L53">view source</a></div></div><div class="public anchor" id="var-send"><h3>send</h3><div class="usage"><code>(send producer topic k v)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L597">view source</a></div></div><div class="public anchor" id="var-send-async"><h3>send-async</h3><div class="usage"><code>(send-async producer topic k v)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L594">view source</a></div></div><div class="public anchor" id="var-shutdown.21"><h3>shutdown!</h3><div class="usage"><code>(shutdown!)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L228">view source</a></div></div><div class="public anchor" id="var-standalone-mock-consumer-opts"><h3>standalone-mock-consumer-opts</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L26">view source</a></div></div><div class="public anchor" id="var-start.21"><h3>start!</h3><div class="usage"><code>(start!)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L215">view source</a></div></div><div class="public anchor" id="var-txfm-messages"><h3>txfm-messages</h3><div class="usage"><code>(txfm-messages consumer topic xf)</code><code>(txfm-messages consumer topic xf options)</code></div><div class="doc"><div class="markdown"><p>Like <code>txfm-subscribed-messages</code>, but subscribes to the <code>topic</code> first.</p></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L587">view source</a></div></div><div class="public anchor" id="var-txfm-subscribed-messages"><h3>txfm-subscribed-messages</h3><div class="usage"><code>(txfm-subscribed-messages consumer xf)</code><code>(txfm-subscribed-messages consumer xf {:keys [timeout ixf rf], :or {timeout 1000, ixf cat, rf conj}})</code></div><div class="doc"><div class="markdown"><p>Helper to txfm messages sent to the <code>consumer</code> on any existing subscriptions. Messages will be transformed by the transducing function <code>xf</code>. Will return as soon as <code>xf</code> indicates it has enough records, or the <code>timeout</code> (in ms, by default 1000) expires. Thus, to avoid waiting for the <code>timeout</code>, include e.g. <code>(take 3)</code> in <code>xf</code>. If the <code>timeout</code> expires, will return any messages transformed so far.</p>
<p>For example,</p>
<pre><code class="clojure">(kafka-mock/send producer "topic" "key" "5")
(kafka-mock/send producer "topic" "key" "6")
(kafka-mock/send producer "topic" "key" "7")
(kafka-mock/send producer "topic" "key" "8")
(.subscribe consumer ["topic"])
(kafka-mock/txfm-subscribed-messages consumer (comp (map :value)
                                                    (map #(Integer/parseInt %))
                                                    (filter even?)
                                                    (take 1)))
;; =&gt; [6]
</code></pre>
<p>By default messages retrieved from <code>(.poll consumer)</code> will be collected as by <code>clojure.core/cat</code> and fed one-by-one through <code>xf</code>. This behvaior can be altered by providing a different <code>ixf</code>. For example, <code>clojure.core/conj</code> will feed each batch through in its entirety. This can be combined with <code>max.poll.records</code> to control batch size.</p>
<p>Also by default, the transformed messages will be accumulated as by <code>clojure.core/conj</code>, and returned. A different reducing function <code>rf</code> can be supplied. For example, if <code>xf</code> produces a stream of numbers, the reducing function <code>clojure.core/+</code> will return their sum.</p></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L540">view source</a></div></div><div class="public anchor" id="var-with-test-broker"><h3>with-test-broker</h3><h4 class="type">macro</h4><div class="usage"><code>(with-test-broker &amp; body)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L600">view source</a></div></div><div class="public anchor" id="var-with-test-producer-consumer"><h3>with-test-producer-consumer</h3><h4 class="type">macro</h4><div class="usage"><code>(with-test-producer-consumer producer-name consumer-name &amp; body)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/Mayvenn/kafka-component/blob/master/src/kafka_component/mock.clj#L607">view source</a></div></div></div></body></html>